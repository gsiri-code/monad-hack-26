(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{63:(e,s,t)=>{"use strict";var a=t(7260);t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},823:(e,s,t)=>{Promise.resolve().then(t.bind(t,7250))},7250:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var a=t(5155),n=t(3735),l=t(63),r=t(2115);let i="0x534b2f3A21130d7a60830c2Df862319e593943A3";function d(e,s){let t=10n**BigInt(s);return"".concat(e/t,".").concat((e%t).toString().padStart(s,"0").slice(0,4))}function c(){var e,s;let{ready:t,balances:l,activeAccount:r}=(0,n.Fl)();if(!t)return(0,a.jsx)("div",{className:"bg-gray-50 rounded-2xl p-6",children:(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Loading balances..."})});let c=null!=(e=null==l?void 0:l["0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE"])?e:0n,o=null!=(s=null==l?void 0:l[i])?s:0n;return(0,a.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold",children:"Shielded Balance"}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-0.5",children:"Only you can see this"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center bg-white rounded-xl px-4 py-3 shadow-sm",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"MON"}),(0,a.jsx)("span",{className:"font-mono font-semibold",children:d(c,18)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center bg-white rounded-xl px-4 py-3 shadow-sm",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"USDC"}),(0,a.jsx)("span",{className:"font-mono font-semibold",children:d(o,6)})]})]}),r&&(0,a.jsxs)("div",{className:"pt-2 border-t border-gray-200",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 font-medium",children:"Your wallet"}),(0,a.jsx)("p",{className:"text-xs font-mono text-gray-600 truncate mt-0.5",children:r.address})]})]})}function o(){let{activeAccount:e}=(0,n.Fl)(),[s,t]=(0,r.useState)([]),[l,i]=(0,r.useState)(""),[d,c]=(0,r.useState)(!1);async function o(){if(!e)return;let s=await fetch("/api/friends?wallet=".concat(e.address)),a=await s.json();t(Array.isArray(a)?a:[])}async function x(){if(l.trim()&&e){c(!0);try{await fetch("/api/friends",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_wallet:e.address,friend_wallet:l.trim()})}),i(""),await o()}finally{c(!1)}}}return(0,r.useEffect)(()=>{o()},[e]),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold",children:"Friends"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"Friend's address",value:l,onChange:e=>i(e.target.value),className:"flex-1 border border-gray-300 rounded-xl px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("button",{onClick:x,disabled:d,className:"bg-blue-600 text-white px-3 py-2 rounded-xl text-sm font-medium hover:bg-blue-700 disabled:opacity-50",children:"Add"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[0===s.length&&(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"No friends yet"}),s.map(e=>{var s,t;return(0,a.jsxs)("div",{className:"flex items-center gap-3 bg-white rounded-xl px-4 py-3 shadow-sm",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-sm",children:null==(s=e.display_name[0])?void 0:s.toUpperCase()}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium truncate",children:e.display_name}),(0,a.jsx)("p",{className:"text-xs font-mono text-gray-400",children:(t=e.wallet_address,"".concat(t.slice(0,6),"...").concat(t.slice(-4)))})]})]},e.id)})]})]})}function x(e){let{onClose:s,onSuccess:t}=e,{activeAccount:l,send:d}=(0,n.Fl)(),[c,o]=(0,r.useState)(""),[x,u]=(0,r.useState)(""),[m,h]=(0,r.useState)(""),[p,f]=(0,r.useState)("public"),[y,g]=(0,r.useState)("idle"),[b,j]=(0,r.useState)("");async function N(){if(!c.trim()||!x||!m.trim())return void j("All fields are required");if(!l)return void j("No wallet connected");g("sending"),j("");try{let e=BigInt(Math.round(1e6*parseFloat(x))),a=await d([{token:i,recipient:c.trim(),amount:e}]);await fetch("/api/social-feed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sender:l.address,receiver:c.trim(),memo:m.trim(),relay_id:a.relayId,visibility:p})}),g("done"),null==t||t(),setTimeout(s,1200)}catch(e){j(e instanceof Error?e.message:"Transfer failed"),g("error")}}return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md shadow-xl",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Pay"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 text-2xl leading-none",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("input",{type:"text",placeholder:"Recipient Unlink address (unlink1...)",value:c,onChange:e=>o(e.target.value),className:"border border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("input",{type:"number",placeholder:"Amount (USDC)",value:x,onChange:e=>u(e.target.value),min:"0",step:"0.01",className:"border border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("input",{type:"text",placeholder:"Memo (e.g. dinner split)",value:m,onChange:e=>h(e.target.value),className:"border border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("div",{className:"flex gap-2",children:["public","friends","private"].map(e=>(0,a.jsx)("button",{onClick:()=>f(e),className:"flex-1 py-2 rounded-xl text-sm font-medium border transition-colors ".concat(p===e?"bg-blue-600 text-white border-blue-600":"border-gray-300 text-gray-600 hover:bg-gray-50"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),b&&(0,a.jsx)("p",{className:"text-red-500 text-sm",children:b}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:["The amount is private. Only the memo and parties are shared with"," ","public"===p?"everyone":"friends"===p?"your friends":"nobody","."]}),(0,a.jsx)("button",{onClick:N,disabled:"sending"===y||"done"===y,className:"bg-blue-600 text-white py-3 rounded-xl font-medium hover:bg-blue-700 disabled:opacity-50",children:"sending"===y?"Sending...":"done"===y?"Sent!":"Pay"})]})]})})}function u(e){return"".concat(e.slice(0,6),"...").concat(e.slice(-4))}function m(e){let{wallet:s}=e,[t,n]=(0,r.useState)([]),[l,i]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{fetch(s?"/api/social-feed?wallet=".concat(s):"/api/social-feed").then(e=>e.json()).then(e=>n(Array.isArray(e)?e:[])).finally(()=>i(!1))},[s]),l)?(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Loading feed..."}):0===t.length?(0,a.jsx)("p",{className:"text-gray-400 text-sm text-center py-8",children:"No payments yet. Send one!"}):(0,a.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,a.jsxs)("div",{className:"border border-gray-100 rounded-xl p-4 bg-white shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[(0,a.jsx)("span",{className:"font-mono text-xs bg-gray-100 px-1.5 py-0.5 rounded",children:u(e.sender)}),(0,a.jsx)("span",{className:"text-gray-500 mx-1.5",children:"paid"}),(0,a.jsx)("span",{className:"font-mono text-xs bg-gray-100 px-1.5 py-0.5 rounded",children:u(e.receiver)})]}),(0,a.jsx)("span",{className:"text-xs text-gray-400 shrink-0",children:new Date(e.created_at).toLocaleDateString()})]}),(0,a.jsx)("p",{className:"mt-1.5 text-gray-700",children:e.memo}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-400 capitalize",children:e.visibility})]},e.id))})}function h(){let{ready:e,activeAccount:s}=(0,n.Fl)(),t=(0,l.useRouter)(),[i,d]=(0,r.useState)(!1),[u,h]=(0,r.useState)(0);return e?s?(0,a.jsxs)("main",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,a.jsxs)("header",{className:"flex items-center justify-between mb-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Benmo"}),(0,a.jsx)("button",{onClick:()=>d(!0),className:"bg-blue-600 text-white px-5 py-2.5 rounded-xl font-medium hover:bg-blue-700",children:"Pay"})]}),(0,a.jsxs)("div",{className:"flex gap-6",children:[(0,a.jsxs)("section",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Feed"})}),(0,a.jsx)(m,{},u)]}),(0,a.jsxs)("aside",{className:"w-72 shrink-0 space-y-4",children:[(0,a.jsx)(c,{}),(0,a.jsx)(o,{})]})]}),i&&(0,a.jsx)(x,{onClose:()=>d(!1),onSuccess:()=>h(e=>e+1)})]}):(t.push("/onboarding"),null):(0,a.jsx)("main",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("p",{className:"text-gray-400",children:"Loading Unlink..."})})}}},e=>{e.O(0,[372,441,255,358],()=>e(e.s=823)),_N_E=e.O()}]);